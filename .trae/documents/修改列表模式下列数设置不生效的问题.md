## 问题分析

在当前实现中，列表模式下的列数设置不生效，因为 `setItemWidth` 函数强制将列表模式的列数设置为1，忽略了用户在设置中配置的列数。

## 解决方案

### 1. 添加获取分类列数的函数

在 `src/pages/item/js/index.ts` 文件中添加 `getColumnNumber` 函数，类似于现有的 `getLayout` 和 `getIconSize` 函数：

```typescript
/**
 * 获取项目列数
 */
function getColumnNumber(classificationId: number | null) {
  if (classificationId) {
    let classification = getClassificationById(classificationId);
    if (classification && classification.data.itemColumnNumber) {
      return classification.data.itemColumnNumber;
    }
  }
  return store.setting.item.columnNumber;
}
```

### 2. 修改 setItemWidth 函数中的列表模式处理

在 `setItemWidth` 函数中，只修改列表模式的处理逻辑，保持其他布局模式不变：

```typescript
// 列表布局
} else if (layout === "list") {
  // 获取列数设置
  let columnNumber = getColumnNumber(classificationId ? parseInt(classificationId) : null);
  // 如果设置了列数且大于1，则使用设置的列数
  if (columnNumber && columnNumber > 1) {
    num = columnNumber;
    minWidth = store.setting.item.width;
  } else {
    // 否则默认一行一个
    num = 1;
    minWidth = width;
  }
}
```

### 3. 修改列表模式下的样式设置

在 `setItemWidth` 函数中，修改列表模式下的样式设置，使其根据列数计算宽度，同时保持其他布局模式的样式设置不变：

```typescript
// 设置项目宽度
items.forEach((item) => {
  const element = item as HTMLElement;
  if (layout === "list") {
    if (num > 1) {
      // 多列列表模式：使用计算的宽度
      element.style.width = `${itemWidth}px`;
      element.style.display = "flex";
      element.style.alignItems = "center";
    } else {
      // 单列列表模式：强制宽度为100%
      element.style.width = "100%";
      element.style.display = "flex";
      element.style.alignItems = "center";
    }
  } else {
    // 其他布局：保持原有样式设置
    element.style.width = `${itemWidth}px`;
  }
});
```

### 4. 导出新函数

在 `src/pages/item/js/index.ts` 文件的导出部分添加 `getColumnNumber` 函数：

```typescript
export {
  setItemWidth,
  getAbbr,
  getItemSearchMap,
  searchItem,
  addItem,
  getItemById,
  updateItem,
  deleteItem,
  deleteItemByClassificationId,
  updateItemOrder,
  getItemListByClassificationId,
  getShowItemListByClassificationId,
  convertItemList,
  showItemList,
  run,
  itemHoverStyle,
  itemRemoveStyle,
  allItemRemoveStyle,
  moveItemByClassificationId,
  getLayout,
  getIconSize,
  getColumnNumber,
  removeInvalidItem,
  getItemByIdList,
  hasChinese,
  getName,
  getItemTitle,
  filterExcludeSearchItemList,
  sort,
};
```

## 预期效果

修改后，当用户在设置中为项目列表模式配置列数时，该设置将生效：

* 列表模式：根据设置的列数显示项目，支持多列布局
* 平铺模式：保持原有行为不变
* 封面模式：保持原有行为不变

这样修改只影响列表模式，不会影响其他布局模式的现有功能。