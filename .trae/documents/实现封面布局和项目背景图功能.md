# 实现封面布局和项目背景图功能

## 1. 添加封面布局类型

### 1.1 修改语言文件
- 在 `commons/data/languages.ts` 中添加封面布局的翻译
- 为简体中文、繁体中文和英文添加 `cover: "封面"` 翻译

### 1.2 更新布局菜单
- 修改 `electron/main/classification/index.ts` 中的 `getItemLayoutMenu` 函数
- 添加封面布局选项到菜单中

### 1.3 更新布局类型定义
- 修改相关代码中的布局类型检查，添加 "cover" 类型支持

## 2. 实现封面布局样式

### 2.1 修改项目宽度设置
- 更新 `src/pages/item/js/index.ts` 中的 `setItemWidth` 函数
- 为封面布局添加特殊处理：宽度100%，高度自适应

### 2.2 更新项目列表组件
- 修改 `src/pages/item/components/List.vue` 中的样式绑定
- 为封面布局添加特殊的CSS类和样式
- 单个项目宽度设置为100%
- 高度自适应，不做限制

## 3. 添加项目背景图功能

### 3.1 更新项目数据结构
- 修改 `types/item.d.ts` 中的 `ItemData` 接口
- 添加以下字段：
  - `backgroundImage: string | null` - 背景图路径或URL
  - `saveBackgroundImage: boolean` - 是否保存背景图到本地
  - `localBackgroundImage: string | null` - 本地保存的背景图路径

### 3.2 更新项目渲染
- 修改 `src/pages/item/components/List.vue` 中的项目渲染
- 添加背景图样式绑定，优先使用本地背景图
- 支持自定义项目背景图

## 4. 实现背景图路径转换

### 4.1 更新路径转换逻辑
- 修改 `electron/main/item/index.ts` 中的 `convertTarget` 函数
- 确保背景图路径也能正确转换为相对路径或绝对路径

### 4.2 更新路径转换函数
- 修改 `electron/main/commons/index.ts` 中的 `convertPath` 函数
- 确保该函数能处理背景图路径

### 4.3 添加背景图路径转换逻辑
- 当项目路径转换时，同步转换背景图路径
- 支持相对路径和绝对路径之间的转换

## 5. 实现封面图预览功能

### 5.1 添加封面图预览组件
- 创建或修改项目编辑界面，添加封面图预览功能
- 支持实时预览选中的背景图效果

### 5.2 添加封面图选择器
- 支持上传本地图片或输入图片URL
- 实时显示预览效果

## 6. 实现封面图保存功能

### 6.1 添加保存选项
- 在项目编辑界面添加勾选框："保存封面图到本地"
- 默认值可设置为false

### 6.2 实现封面图处理逻辑
- 添加图片缩放和保存功能
- 最大宽高限制为640*480
- 保存到项目路径下的".wstart"目录
- 文件名固定为"cover.png"

### 6.3 更新文件系统操作
- 确保创建".wstart"目录的权限
- 处理图片复制和缩放
- 支持不同图片格式

## 7. 测试和优化

### 7.1 测试布局切换
- 确保封面布局能正常切换
- 测试不同屏幕尺寸下的显示效果

### 7.2 测试背景图功能
- 确保背景图能正确显示
- 测试不同尺寸和格式的背景图
- 测试背景图预览功能

### 7.3 测试背景图路径转换
- 测试项目路径转换时，背景图路径是否能正确转换
- 测试相对路径和绝对路径之间的转换
- 测试不同操作系统下的路径转换

### 7.4 测试封面图保存功能
- 测试保存选项的勾选效果
- 验证图片是否正确保存到指定目录
- 测试不同尺寸图片的缩放效果

### 7.5 优化样式细节
- 调整封面布局的间距和对齐
- 确保背景图与文字的可读性
- 优化封面图预览的用户体验

## 实现文件清单

1. `commons/data/languages.ts` - 添加封面翻译
2. `electron/main/classification/index.ts` - 更新布局菜单
3. `src/pages/item/js/index.ts` - 修改项目宽度设置
4. `src/pages/item/components/List.vue` - 更新项目列表组件
5. `types/item.d.ts` - 更新项目数据结构
6. `electron/main/item/index.ts` - 更新路径转换逻辑
7. `electron/main/commons/index.ts` - 更新路径转换函数
8. 项目编辑相关组件 - 添加背景图设置和预览
9. 新增图片处理工具函数 - 实现图片缩放和保存
10. 更新项目数据处理逻辑 - 支持背景图CRUD操作

这个计划将实现用户要求的封面布局，包括100%宽度的平铺样式、自定义背景图功能、封面图预览以及本地保存功能，同时确保背景图路径能正确转换为相对路径。